%
% @author Michal Koutn√Ω <michal@fykos.cz>
%
% @description Manipulation with signrature "database".
%
\RequirePackage{etoolbox}

\newcommand\newsignature[4]{%
  \expandafter\gdef\csname sign@me#1\endcsname{%
    #2%
  }%
  \expandafter\gdef\csname sigm@il#1\endcsname{%
    #3%
  }%
  \expandafter\gdef\csname sigs@m#1\endcsname{%
    #4%
  }%
}

\newcommand\signame[1]{%
  \lazy@signatures%
  \expandafter\ifx\csname sign@me#1\endcsname\relax
  \PackageWarning{fkssignature}{Undefined name #1}
  \else
  \expandafter\csname sign@me#1\endcsname\fi
}
\newcommand\sigmail[1]{%
  \lazy@signatures%
  \expandafter\csname sigm@il#1\endcsname
}

\newcommand\sign@tureraw[1]{%
\signame{#1} <\sigmail{#1}>, %
}

\newcommand*{\sign@ture}[1]{%
\hspace{10pt}
\begin{tabular}{c}
\sigstyle{\signame{#1}}\\
\mail{\sigmail{#1}}
\end{tabular}}

\newcommand*{\signature}[1]{%
  \let\do\sign@ture
  \hfill\expandafter\docsvlist\expandafter{#1}
}

\newcommand*{\signatureraw}[1]{%
  \let\do\sign@tureraw
  {\expandafter\docsvlist\expandafter{#1}}
}

% signature style
\newcommand\sigstyle[1]{{\bfseries\itshape#1}}

\ifx\@signaturesfile\@undefined
\def\@signaturesfile{signatures.tex}
\fi
\renewcommand\@signaturesfile{signatures.tex}
\newcommand\signaturesfile[1]{\renewcommand\@signaturesfile{#1}}

\newcommand\lazy@signatures{%
\ifx\@signaturesloaded\@undefined%
\input{\@signaturesfile}%
\gdef\@signaturesloaded\relax%
\fi}
